!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?exports.c3=b():a.c3=b()}(this,function(){var a;!function(a){function b(a){var b=d.createElement("style"),c=d.head;b.type="text/css";var e=b.id="c3-inject-css-"+Math.random().toString(16).slice(2).toUpperCase();return b.styleSheet?b.styleSheet.cssText=a:b.appendChild(d.createTextNode(a)),c.appendChild(b),e}var c="\n.c3-stage {\n  -webkit-perspective: 800px;\n          perspective: 800px;\n  top: 0px;\n  left: 0px;\n  overflow: hidden;\n}\n.c3-stage,\n.c3-stage .c3-camera,\n.c3-stage .c3-sprite,\n.c3-stage .c3-plane,\n.c3-stage .c3-cube,\n.c3-stage .c3-cylinder {\n  position: absolute;\n  -webkit-transform-origin: 50% 50% 0px;\n          transform-origin: 50% 50% 0px;\n  -webkit-transform-style: preserve-3d;\n          transform-style: preserve-3d;\n}\n.c3-stage .c3-camera {\n  top: 50%;\n  left: 50%;\n  will-change: transform;\n}",d=document;b(c)}(a||(a={}));var a;!function(a){function b(a,b,c){if(q(b)&&3===arguments.length&&(e={},e[b]=c,b=e),q(a))a=o(a);else if(Array.isArray(a)){var d=[];a.forEach(function(a){return d=d.concat(q(a)?o(a):a)}),a=d}else a="object"==typeof a&&a.length?n(a):[a];a.forEach(function(a){return p(a,b)});var e}var c=["-webkit-","-moz-","-ms-"],d=["Webkit","Moz","ms"],e=Object.create(null),f=/([a-z\d])([A-Z])/g,g=/-(\w)/g,h=null,i=function(a){return a.replace(f,"$1-$2").toLowerCase()},j=function(a){return a.replace(g,function(a,b){return b?b.toUpperCase():""})},k=function(a){if(e[a])return e[a];var b=l(a);return e[a]=e[b]=b},l=function(a){a=i(a);var b=j(a),e=b.charAt(0).toUpperCase()+b.slice(1);h||(h=document.createElement("div"));for(var f,g=c.length;g--;)if(f=d[g]+e,f in h.style)return c[g]+a;return b in h.style?a:void 0},m=document,n=function(a){return[].slice.call(a)},o=function(a){return n(m.querySelectorAll(a))},p=function(a,b){if(a instanceof Element){var c,d,e;if(q(b))return void(a.style.cssText=b);for(c in b)b.hasOwnProperty(c)&&(e=b[c],d=k(c),null!==e&&(e+=""),e?a.style.setProperty(d,e):a.style.removeProperty(d))}},q=function(a){return"string"==typeof a};a.style=b}(a||(a={}));var a;!function(a){function b(a,b){return Math.random()*(b-a)+a}function c(a,c){return Math.round(b(a,c))}function d(){return"#"+((1<<24)*Math.random()|0).toString(16)}a.rnd=b,a.rndInt=c,a.rndColor=d}(a||(a={}));var a;!function(a){a.$hashCount=0;var b=function(){function b(){this.$hashCode=a.$hashCount++}return Object.defineProperty(b.prototype,"hashCode",{get:function(){return this.$hashCode},enumerable:!0,configurable:!0}),b}();a.HashObject=b}(a||(a={}));var a,b=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};!function(a){var c=[],d=function(a){function d(b,c,d){a.call(this),this.set(b,c,d)}return b(d,a),d.release=function(a){a&&c.push(a)},d.create=function(a,b,e){var f=c.pop();return f||(f=new d(a,b,e)),f.set(a,b,e),f},d.distance=function(a,b){return Math.sqrt((a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y)+(a.z-b.z)*(a.z-b.z))},d.prototype.set=function(a,b,c){return void 0===a&&(a=0),"string"==typeof a||"string"==typeof b||"string"==typeof c?(a=Number(a),b=Number(b),c=Number(c),a&&(this.x+=a),b&&(this.y+=b),c&&(this.z+=c),this):(void 0===b?b=c=0:void 0===c&&(c=0),this.x=a,this.y=b,this.z=c,this)},d.prototype.clone=function(){return new d(this.x,this.y,this.z)},d.prototype.equals=function(a){return this.x===a.x&&this.y===a.y&&this.z===a.z},d.prototype.move=function(a,b,c){return void 0===a&&(a=1),1===arguments.length?b=c=a:2===arguments.length&&(c=0),this.x+=a,this.y+=b,this.z+=c,this},Object.defineProperty(d.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},enumerable:!0,configurable:!0}),d.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", z="+this.z+")"},d}(a.HashObject);a.Point=d}(a||(a={}));var a;!function(a){var c;!function(a){a[a.color=0]="color",a[a.position=1]="position",a[a.size=2]="size",a[a.repeat=3]="repeat",a[a.origin=4]="origin",a[a.clip=5]="clip",a[a.attachment=6]="attachment",a[a.image=7]="image",a[a.filter=8]="filter",a[a.hidden=9]="hidden",a[a.visible=10]="visible",a[a.backface=11]="backface",a[a.opacity=12]="opacity"}(c||(c={}));var d=function(a){function d(b){void 0===b&&(b={}),a.call(this),this.$_attrs=["transparent","0% 0%","auto auto","repeat","","","","","",!1,!0,!0,1],this.$targets=[],this.update(b)}return b(d,a),d.prototype.render=function(a){var b=this.$_attrs,d={background:"none"},e="background";b[c.hidden]||(d[e]=b[c.color]+" "+b[c.image]+" "+b[c.position]+" "+b[c.repeat],b[c.size]&&(d[e+"Size"]=b[c.size]),b[c.attachment]&&(d[e+"Attachment"]=b[c.attachment]),b[c.clip]&&(d[e+"Clip"]=b[c.clip]),b[c.origin]&&(d[e+"Origin"]=b[c.origin]),b[c.filter]&&(d.filter=b[c.filter])),d.visibility=b[c.visible]?"visible":"hidden",d["backface-visibility"]=b[c.backface]?"visible":"hidden","number"==typeof b[c.opacity]&&(d.opacity=b[c.opacity]);var f=function(a){a.css(d)};a?f(a):this.$targets.forEach(f)},d.prototype.clone=function(){var a=new d,b=this.$_attrs,e={};return b.forEach(function(a,b){e[c[b]]=a}),a.update(e),a},d.prototype.update=function(a){void 0===a&&(a={});var b,d,e=this.$_attrs;for(d in a)b=c[d],"number"==typeof b&&(e[b]=a[d]);this.render()},d.prototype.getAttr=function(a){return this.$_attrs[c[a]]},d.prototype._addTarget=function(a){this.$targets.push(a)},d.prototype._removeTarget=function(a){var b=this.$targets.indexOf(a);-1!==b&&this.$targets.splice(b,1)},d}(a.HashObject);a.Material=d}(a||(a={}));var a;!function(a){var c="px",d=function(d){function e(){d.call(this),this.$position=new a.Point(0,0,0),this.$translate=new a.Vector3D(0,0,0),this.$scale=new a.Vector3D(1,1,1),this.$rotate=new a.Quaternion(0,0,0),this.$matrix3D=new a.Matrix3D,this.$size=new a.Point,this.$parent=null,this.$visible=!0,this.$opacity=1,this.$backface=!0,this.$className="",this.el=document.createElement("div"),this._initialize()}return b(e,d),e.prototype.css=function(b){return a.css(this.el,b),this},e.prototype.on=function(a,b,c){return void 0===c&&(c=!1),this.el.addEventListener(a,b.bind(this),c),this},e.prototype.off=function(a,b,c){return void 0===c&&(c=!1),this.el.removeEventListener(a,b.bind(this),c),this},e.prototype.once=function(a,b,c){void 0===c&&(c=!1),b.bind(this);var d=this.el,e=function(){b(),d.removeEventListener(a,e,c)};return d.addEventListener(a,e,c),this},e.prototype.position=function(a,b,c){return this.$position.set(a,b,c),this},e.prototype.getPosition=function(){return this.$position},e.prototype.size=function(a,b,c){return this.$size.set(a,b,c),this._doUpdateSize(),this},e.prototype.getSize=function(){return this.$size},e.prototype._doUpdateSize=function(){var a={width:this.$size.x+c,height:this.$size.y+c};this.$size.z&&(a.zIndex=this.$size.z),this.css(a)},e.prototype.translate=function(a,b,c){return this.$translate.set(a,b,c),this},e.prototype.getTranslate=function(){return this.$translate},e.prototype.rotate=function(a,b,c){return this.$rotate.set(a,b,c),this},e.prototype.getRotate=function(){return this.$rotate},e.prototype.scale=function(a,b,c){return this.$scale.set(a,b,c),this},e.prototype.getScale=function(){return this.$scale},e.prototype.update=function(){var a=this.$position,b="";(a.x||a.y||a.z)&&(b=" translate3d("+a.x+"px,"+a.y+"px,"+a.z+"px) "),this.css({transform:"translate3d(-50%, -50%, 0px) "+this._getMatrix3dString()+b})},e.prototype._getMatrix3dString=function(){return this.$matrix3D.makeTransform(this.$translate,this.$scale,this.$rotate),this.$matrix3D.toString()},e.prototype._initialize=function(){},Object.defineProperty(e.prototype,"visible",{get:function(){return this.$visible},set:function(a){this.$visible=a,this.el.style.opacity=a?"visible":"hidden"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"opacity",{get:function(){return this.$opacity},set:function(a){this.$opacity=a,this.el.style.opacity=a.toString()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backface",{get:function(){return this.$backface},set:function(a){this.$backface=a,this.css({visibility:a?"visible":"hidden"})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this.$className},set:function(a){this.$className=a,this.el.className=a},enumerable:!0,configurable:!0}),e}(a.HashObject);a.Display=d}(a||(a={}));var a;!function(a){var c=function(a){function c(){a.call(this),this.$children=[],this.el.className="c3-sprite"}return b(c,a),Object.defineProperty(c.prototype,"children",{get:function(){return this.$children},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"numChildren",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),c.prototype.addChild=function(){for(var a=this,b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];b.forEach(function(b){a.$children.push(b),a.el.appendChild(b.el),b.$parent=a})},c.prototype.removeChild=function(){for(var a=this,b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];b.forEach(function(b){var c=a.$children.indexOf(b);-1!==c&&(a.el.removeChild(b.el),a.$children.splice(c,1),b.$parent=null)})},Object.defineProperty(c.prototype,"material",{get:function(){return this.$material},set:function(a){var b=[];b=Array.isArray(a)?a:[a],this.$material=b;var c=b.length;if(1!==c&&c!==this.$children.length)throw"材质为1个或者与子Plane数量相同";this.$children.forEach(function(a,d){return a.material=b[1===c?0:d]})},enumerable:!0,configurable:!0}),c}(a.Display);a.Sprite=c}(a||(a={}));var a;!function(a){function b(b,c){void 0===c&&(c={}),a.style(b,c)}a.css=b}(a||(a={}));var a;!function(a){var c=function(a){function c(){a.call(this),this.fov=50,this.className="c3-camera"}return b(c,a),c.prototype.update=function(){this.css({transform:this._getMatrix3dString()})},c}(a.Sprite);a.Camera=c}(a||(a={}));var a;!function(a){var c,d=function(a){return Math.round(a)};!function(a){a[a.FRONT=0]="FRONT",a[a.BACK=1]="BACK",a[a.LEFT=2]="LEFT",a[a.RIGHT=3]="RIGHT",a[a.UP=4]="UP",a[a.DOWN=5]="DOWN"}(c||(c={}));var e=function(e){function f(b,c,d){e.call(this),this.xWidth=0,this.yWidth=0,this.zWidth=0,this.className="c3-cube";for(var f,g=0;6>g;g++)f=new a.Plane(0,0),this.addChild(f);this.xWidth=b,this.yWidth=c,this.zWidth=d,this.updateCube()}return b(f,e),f.prototype.updateCube=function(){var a=this,b=a.xWidth,e=a.yWidth,f=a.zWidth,g=this.$children,h=d(b/2),i=d(e/2),j=d(f/2);g[c.FRONT].size(h,i,0).translate(0,0,-j/2).rotate(0,0,0).update(),g[c.BACK].size(h,i,0).translate(0,0,j/2).rotate(0,180,0).update(),g[c.LEFT].size(j,i,0).translate(-h/2,0,0).rotate(0,90,0).update(),g[c.RIGHT].size(j,i,0).translate(h/2,0,0).rotate(0,-90,0).update(),g[c.UP].size(h,j,0).translate(0,-i/2,0).rotate(-90,0,0).update(),g[c.DOWN].size(h,j,0).translate(0,i/2,0).rotate(90,0,0).update()},f}(a.Sprite);a.Cube=e}(a||(a={}));var a;!function(a){var c=function(c){function d(b,d,e){c.call(this),this.className="c3-cylinder",this.w=b,this.h=d,this.n=e;for(var f;e--;)f=new a.Plane(0,0),this.addChild(f);this.updateCube()}return b(d,c),d.prototype.updateCube=function(){var a=this,b=a.w,c=a.h,d=a.n,e=this.$children,f=b/2/Math.tan(360/d/2/180*Math.PI),g=360/d;e.forEach(function(a,d){a.size(b,c).position(0,0,f).rotate(0,d*g).update()})},d}(a.Sprite);a.Cylinder=c}(a||(a={}));var a;!function(a){var c=function(a){function c(b,c,d){void 0===d&&(d=0),a.call(this),this.size(b,c,d),this.className="c3-plane",this.update()}return b(c,a),Object.defineProperty(c.prototype,"material",{get:function(){return this.$material},set:function(a){this.$material&&this.$material._removeTarget(this),this.$material=a,a._addTarget(this),a.render(this)},enumerable:!0,configurable:!0}),c}(a.Display);a.Plane=c}(a||(a={}));var a;!function(a){var c=function(c){function d(b,d,e){c.call(this),this.size(b,d,e),this.className="c3-stage";var f=this.$camera=new a.Camera;c.prototype.addChild.call(this,f)}return b(d,c),Object.defineProperty(d.prototype,"camera",{get:function(){return this.$camera},enumerable:!0,configurable:!0}),d.prototype.addChild=function(a){this.$camera.addChild(a)},d.prototype.removeChild=function(a){this.$camera.removeChild(a)},d.prototype.attach=function(a){var b;b="string"==typeof a?document.querySelector(a):a,b.appendChild(this.el)},d.prototype.update=function(){var b=this.$size,c=.5/Math.tan(.5*this.$camera.fov*a.MatrixMathUtil.DEGREES_TO_RADIANS)*b.y,d=Math.round(c);this.css({perspective:d+"px"}),this.$camera.update(),this.translate(0,0,0)},d}(a.Sprite);a.Stage=c}(a||(a={}));var a;!function(a){var b=function(){function a(){}return a.ADDED="added",a.REMOVED="removed",a.UPDATE="update",a.RENDER="render",a.RESIZE="resize",a}();a.EventType=b}(a||(a={}));var a;!function(a){var b=function(){function b(a){void 0===a&&(a=null),this.result=new Float32Array(16),this.m=new Float32Array(16),this.oRawData=new Float32Array(16),a?this.rawData=a:this.rawData=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return b.prototype.lookAt=function(a,b,c){var d=b.subtract(a);d.normalize();var e=c.crossProduct(d);e.normalize();var f=d.crossProduct(e),g=this.rawData;g[0]=e.x,g[1]=f.x,g[2]=d.x,g[3]=0,g[4]=e.y,g[5]=f.y,g[6]=d.y,g[7]=0,g[8]=e.z,g[9]=f.z,g[10]=d.z,g[11]=0,g[12]=-e.dotProduct(a),g[13]=-f.dotProduct(a),g[14]=-d.dotProduct(a),g[15]=1},b.prototype.clone=function(){var a=new b;return a.copyFrom(this),a},b.prototype.copyFrom=function(a){for(var b=a.rawData.length,c=0;b>c;c++)this.rawData[c]=a.rawData[c];return this},b.prototype.copyRawDataFrom=function(a,b,c){void 0===b&&(b=0),void 0===c&&(c=!1),c&&this.transpose();for(var d=a.length-b,e=0;d>e;e++)this.rawData[e]=a[e+b];c&&this.transpose()},b.prototype.identity=function(){for(var a=0;16>a;a++)this.rawData[a]=a%5?0:1},b.prototype.fill=function(a){for(var b=0;16>b;b++)this.rawData[b]=a},b.prototype.makeTransform=function(b,c,d){var e=this.rawData,f=a.MatrixMathUtil.CALCULATION_MATRIX.rawData;d.toMatrix3D(a.MatrixMathUtil.CALCULATION_MATRIX),e[0]=f[0]*c.x,e[1]=f[1]*c.y,e[2]=f[2]*c.z,e[3]=0,e[4]=f[4]*c.x,e[5]=f[5]*c.y,e[6]=f[6]*c.z,e[7]=0,e[8]=f[8]*c.x,e[9]=f[9]*c.y,e[10]=f[10]*c.z,e[11]=0,e[12]=b.x,e[13]=b.y,e[14]=b.z,e[15]=1},b.prototype.transpose=function(){for(var a=(this.rawData,this.oRawData),b=0;b<a.length;b++)a[b]=this.rawData[b];a[1]=a[4],a[2]=a[8],a[3]=a[12],a[4]=a[1],a[6]=a[9],a[7]=a[13],a[8]=a[2],a[9]=a[6],a[11]=a[14],a[12]=a[3],a[13]=a[7],a[14]=a[11]},b.getAxisRotation=function(a,c,d,e){var f,g,h=new b,i=e*(Math.PI/180),j=Math.cos(i),k=Math.sin(i),l=1-j;return h.rawData[0]=j+a*a*l,h.rawData[5]=j+c*c*l,h.rawData[10]=j+d*d*l,f=a*c*l,g=d*k,h.rawData[1]=f+g,h.rawData[4]=f-g,f=a*d*l,g=c*k,h.rawData[8]=f+g,h.rawData[2]=f-g,f=c*d*l,g=a*k,h.rawData[9]=f-g,h.rawData[6]=f+g,h},b.prototype.toString=function(){for(var a=[],b=this.rawData,c=0;16>c;c++)a.push(Math.round(1e3*b[c])/1e3);return"matrix3d("+a.join(",")+")"},b}();a.Matrix3D=b}(a||(a={}));var a;!function(a){var b=function(){function a(a,b,c,d){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),this.x=0,this.y=0,this.z=0,this.w=0,this.x=a,this.y=b,this.z=c,this.w=d}return Object.defineProperty(a.prototype,"length",{get:function(){return Math.sqrt(this.lengthSquared)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"lengthSquared",{get:function(){return this.x*this.x+this.y*this.y+this.z*this.z},enumerable:!0,configurable:!0}),a.prototype.add=function(b){return new a(this.x+b.x,this.y+b.y,this.z+b.z,this.w+b.w)},a.prototype.clone=function(){return new a(this.x,this.y,this.z,this.w)},a.prototype.copyFrom=function(a){this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w},a.prototype.crossProduct=function(b){return new a(this.y*b.z-this.z*b.y,this.z*b.x-this.x*b.z,this.x*b.y-this.y*b.x,1)},a.prototype.decrementBy=function(a){this.x-=a.x,this.y-=a.y,this.z-=a.z},a.distance=function(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.z-b.z;return Math.sqrt(c*c+d*d+e*e)},a.prototype.dotProduct=function(a){return this.x*a.x+this.y*a.y+this.z*a.z},a.prototype.equals=function(a,b){return void 0===b&&(b=!1),this.x==a.x&&this.y==a.y&&this.z==a.z&&(!b||this.w==a.w)},a.prototype.incrementBy=function(a){this.x+=a.x,this.y+=a.y,this.z+=a.z},a.prototype.divide=function(b){return b instanceof a?new a(this.x/b.x,this.y/b.y,this.z/b.z):(this.x=this.x/b,this.y=this.y/b,this.z=this.z/b,this)},a.prototype.negate=function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},a.prototype.normalize=function(a){if(void 0===a&&(a=1),0!=this.length){var b=a/this.length;return this.x*=b,this.y*=b,void(this.z*=b)}},a.prototype.scaleBy=function(a){this.x*=a,this.y*=a,this.z*=a},a.prototype.setTo=function(a,b,c,d){void 0===d&&(d=1),this.x=a,this.y=b,this.z=c,this.w=d},a.prototype.set=function(a,b,c){return void 0===a&&(a=0),"string"==typeof a||"string"==typeof b||"string"==typeof c?(a=Number(a),b=Number(b),c=Number(c),a&&(this.x+=a),b&&(this.y+=b),c&&(this.z+=c),this):(void 0===b?b=c=0:void 0===c&&(c=0),this.x=a,this.y=b,this.z=c,this)},a.prototype.subtract=function(b,c){return void 0===c&&(c=null),c||(c=new a),c.setTo(this.x-b.x,this.y-b.y,this.z-b.z),c},a.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},a.prototype.parsing=function(a){var b=a.split(-1!==a.indexOf(",")?",":" ");b.length<3||(this.x=parseFloat(b[0]),this.y=parseFloat(b[1]),this.z=parseFloat(b[2]))},a.X_AXIS=new a(1,0,0),a.Y_AXIS=new a(0,1,0),a.Z_AXIS=new a(0,0,1),a}();a.Vector3D=b}(a||(a={}));var a;!function(a){var c=function(c){function d(a,b,d,e){void 0===a&&(a=0),void 0===b&&(b=0),void 0===d&&(d=0),void 0===e&&(e=1),c.call(this,a,b,d,e),this._x=0,this._y=0,this._z=0}return b(d,c),d.prototype.fromEulerAngles=function(b,c,d){b*=a.MatrixMathUtil.DEGREES_TO_RADIANS,c*=a.MatrixMathUtil.DEGREES_TO_RADIANS,d*=a.MatrixMathUtil.DEGREES_TO_RADIANS;var e=.5*b,f=.5*c,g=.5*d,h=Math.cos(e),i=Math.sin(e),j=Math.cos(f),k=Math.sin(f),l=Math.cos(g),m=Math.sin(g);return this.w=h*j*l+i*k*m,this.x=i*j*l-h*k*m,this.y=h*k*l+i*j*m,this.z=h*j*m-i*k*l,this},d.prototype.set=function(a,b,c){return void 0===a&&(a=0),"string"==typeof a||"string"==typeof b||"string"==typeof c?(a=Number(a),b=Number(b),c=Number(c),a&&(this._x+=a),b&&(this._y+=b),c&&(this._z+=c),this.fromEulerAngles(this._x,this._y,this._z),this):(void 0===b?b=c=0:void 0===c&&(c=0),this._x=a,this._y=b,this._z=c,this.fromEulerAngles(a,b,c),this)},d.prototype.toString=function(){return"("+this.x+","+this.y+","+this.z+","+this.w+")"},d.prototype.toMatrix3D=function(b){void 0===b&&(b=null);var c=a.MatrixMathUtil.RAW_DATA_CONTAINER,d=2*this.x*this.y,e=2*this.x*this.z,f=2*this.x*this.w,g=2*this.y*this.z,h=2*this.y*this.w,i=2*this.z*this.w,j=this.x*this.x,k=this.y*this.y,l=this.z*this.z,m=this.w*this.w;return c[0]=j-k-l+m,c[4]=d-i,c[8]=e+h,c[12]=0,c[1]=d+i,c[5]=-j+k-l+m,c[9]=g-f,c[13]=0,c[2]=e-h,c[6]=g+f,c[10]=-j-k+l+m,c[14]=0,c[3]=0,c[7]=0,c[11]=0,c[15]=1,b?(b.copyRawDataFrom(c),b):new a.Matrix3D(new Float32Array(c))},d.prototype.clone=function(){return new d(this.x,this.y,this.z,this.w)},d}(a.Vector3D);a.Quaternion=c}(a||(a={}));var a;return function(a){var b=function(){function b(){}return b.quaternion2matrix=function(c,d){void 0===d&&(d=null);var e=c.x,f=c.y,g=c.z,h=c.w,i=e*e,j=e*f,k=e*g,l=e*h,m=f*f,n=f*g,o=f*h,p=g*g,q=g*h,r=b.RAW_DATA_CONTAINER;return r[0]=1-2*(m+p),r[1]=2*(j+q),r[2]=2*(k-o),r[4]=2*(j-q),r[5]=1-2*(i+p),r[6]=2*(n+l),r[8]=2*(k+o),r[9]=2*(n-l),r[10]=1-2*(i+m),r[3]=r[7]=r[11]=r[12]=r[13]=r[14]=0,r[15]=1,d?(d.copyRawDataFrom(r),d):new a.Matrix3D(new Float32Array(r))},b.RADIANS_TO_DEGREES=180/Math.PI,b.DEGREES_TO_RADIANS=Math.PI/180,b.RAW_DATA_CONTAINER=new Float32Array(16),b.CALCULATION_MATRIX=new a.Matrix3D,b.CALCULATION_QUATERNION=new a.Quaternion,b.CALCULATION_VECTOR3D=new a.Vector3D,b}();a.MatrixMathUtil=b}(a||(a={})),a});